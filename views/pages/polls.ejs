<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polls</title>
</head>
<body onload="load(<%-pollStatus%>, <%-posPollRes%>, <%-posTextRes%>)">
    <h1 id="noPoll">No Poll Is Active Currently</h1>
    <div id="poll">
    <form id="pollForm">
        
    </form>
    <button onclick="submitPoll(<%-posPollRes%>)">Submit</button>
</div>
</body>
<script src="/socket.io/socket.io.js"></script>

<script>
            var socket = io();
            var resTextBox = document.getElementById('resTextBox')
            var pollForm = document.getElementById('pollForm')
            function submitPoll(posPollRes) {
                var radios = document.getElementsByTagName('input')
                var lettRes = ''
                var textRes = ''
                for (var i = 0; i < radios.length; i++) {

                    if (radios[i].type === 'radio' && radios[i].checked) {
                        // get value, set checked flag or do whatever you need to
                        lettRes = radios[i].value; 
                              
                    }
                    if (radios[i].type === 'text') {
                        textRes = radios[i].value
                    }
                    
                }
                console.log(textRes);
                socket.emit('pollResp', lettRes, textRes);
            }

            
            var poll = document.getElementById('poll')
            var noPoll = document.getElementById('noPoll')
            function load(pollStatus, posPollRes, posTextRes) {
                if (pollStatus) {
                    noPoll.style.display = 'none'
                    poll.style.display = 'block'
                    var letters = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']
                    for (let i = 0; i < posPollRes; i++) {
                        pollForm.innerHTML += `<input type="radio" name="poll" id="${letters[i]}" value="${letters[i]}"> <label for="${letters[i]}">${letters[i].toUpperCase()}</label>`
                    }
                    if (posTextRes) {
                        pollForm.innerHTML += `<br><input type="text" name="resText" id="resTextBox">`
                    }
                } else {
                    noPoll.style.display = 'block'
                    poll.style.display = 'none'
                }

            }

            socket.on('reload', function() {
                location.reload()
            })
</script>
</html>